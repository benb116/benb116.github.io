/*
 *  patch-panel - v0.0.3
 *  Makes responsive grid + panel layouts possible.
 *  http://alecortega.com
 *
 *  Made by Alec Ortega
 *  Under MIT License
 */
!function(a,b){"use strict";function c(b,c){this.element=b,this.settings=a.extend({},e,c),this._defaults=e,this._name=d,this.init()}var d="patchpanel",e={buttonSelector:".patch-button",itemSelector:".patch-item",panelSelector:".patch-panel",toggleSpeed:300};a.extend(c.prototype,{init:function(){this.buildCache(),this.bindEvents(),this.initializePanels()},buildCache:function(){this.$window=a(b),this.$container=a(this.element),this.$itemCollection=a(this.element).children(this.settings.itemSelector),this.$patchButton=a(this.settings.buttonSelector),this.windowWidth=a(b).width(),this.itemSelector=this.settings.itemSelector,this.panelSelector=this.settings.panelSelector},bindEvents:function(){var b=this;b.$patchButton.on("click",function(c){c.preventDefault();var d=a(this),e=b.isPanelOpen(),f=a(b.panelSelector+"[data-patch-panel="+d.attr("data-patch-panel")+"]");e?e.attr("data-patch-panel")===f.attr("data-patch-panel")?b.togglePanel(e):e.attr("data-patch-panel")!==f.attr("data-patch-panel")&&(b.appendPanel(d,f),b.togglePanel(e),b.togglePanel(f)):(b.appendPanel(d,f),b.togglePanel(f))});var c=b.hidePanel();b.$window.on("resize",c)},hidePanel:function(){var a=this;return a.debounce(function(){var b=a.isPanelOpen();b&&a.windowWidth!==a.$window.width()&&(b.toggleClass("open").hide(),a.windowWidth=a.$window.width())},200)},appendPanel:function(b,c){var d=this,e=b.closest(d.itemSelector),f=a(d.$itemCollection).index(e),g=Math.floor(d.$container.width()/e.width()),h=Math.floor((e.position().left-1)/e.width());a(d.$itemCollection[f+(g-h-1)]).append().after(c)},debounce:function(a,b,c){var d;return function(){var e=this,f=arguments,g=function(){d=null,c||a.apply(e,f)},h=c&&!d;clearTimeout(d),d=setTimeout(g,b),h&&a.apply(e,f)}},isPanelOpen:function(){var b=a(this.panelSelector+".open");return b.length>0?b:!1},initializePanels:function(){var b=this;a(this.panelSelector).hide(),b.$container.css("position","relative")},togglePanel:function(a){a.stop().toggleClass("open").slideToggle(this.settings.toggleSpeed)}}),a.fn[d]=function(b){return this.each(function(){a.data(this,"plugin_"+d)||a.data(this,"plugin_"+d,new c(this,b))})}}(jQuery,window,document);